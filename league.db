import sqlite3

# --- The teams data ---
teams_data = [
    {
        "name": "Diego",
        "wins": 0,
        "draws": 0,
        "losses": 0,
        "players": [
            {"name": "Diego", "goals": 0, "assists": 0},
            {"name": "Fernando", "goals": 0, "assists": 0},
            {"name": "Jon Jon", "goals": 0, "assists": 0},
            {"name": "Jordan", "goals": 0, "assists": 0},
            {"name": "Jose Marban", "goals": 0, "assists": 0},
            {"name": "Josh G", "goals": 0, "assists": 0},
            {"name": "Noah", "goals": 0, "assists": 0},
            {"name": "David", "goals": 0, "assists": 0},
            {"name": "Zach", "goals": 0, "assists": 0},
            {"name": "Zameer", "goals": 0, "assists": 0}
        ]
    },
    {
        "name": "Fernando",
        "wins": 0,
        "draws": 0,
        "losses": 0,
        "players": [
            {"name": "Diego", "goals": 0, "assists": 0},
            {"name": "Fernando", "goals": 0, "assists": 0},
            {"name": "Jon Jon", "goals": 0, "assists": 0},
            {"name": "Jordan", "goals": 0, "assists": 0},
            {"name": "Jose Marban", "goals": 0, "assists": 0},
            {"name": "Josh G", "goals": 0, "assists": 0},
            {"name": "Noah", "goals": 0, "assists": 0},
            {"name": "David", "goals": 0, "assists": 0},
            {"name": "Zach", "goals": 0, "assists": 0},
            {"name": "Zameer", "goals": 0, "assists": 0}
        ]
    },
    # ... repeat the other 8 teams exactly like above ...
]

# --- Connect to SQLite database ---
conn = sqlite3.connect("league.db")
c = conn.cursor()

# --- Create tables ---
c.execute("""
CREATE TABLE IF NOT EXISTS teams (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT UNIQUE,
    played INTEGER DEFAULT 0,
    wins INTEGER DEFAULT 0,
    draws INTEGER DEFAULT 0,
    losses INTEGER DEFAULT 0,
    points INTEGER DEFAULT 0
)
""")

c.execute("""
CREATE TABLE IF NOT EXISTS players (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT,
    team_id INTEGER,
    goals INTEGER DEFAULT 0,
    assists INTEGER DEFAULT 0,
    clean_sheets INTEGER DEFAULT 0,
    goal_line_clearances INTEGER DEFAULT 0,
    FOREIGN KEY(team_id) REFERENCES teams(id)
)
""")

# --- Insert data ---
for team in teams_data:
    played = team.get('wins', 0) + team.get('draws', 0) + team.get('losses', 0)
    points = team.get('wins', 0) * 3 + team.get('draws', 0)

    c.execute("""
        INSERT OR IGNORE INTO teams (name, wins, draws, losses, played, points)
        VALUES (?, ?, ?, ?, ?, ?)
    """, (team['name'], team.get('wins', 0), team.get('draws', 0), team.get('losses', 0), played, points))

    # Get team id
    c.execute("SELECT id FROM teams WHERE name=?", (team['name'],))
    team_id = c.fetchone()[0]

    # Insert players
    for player in team['players']:
        c.execute("""
            INSERT OR IGNORE INTO players (name, team_id, goals, assists)
            VALUES (?, ?, ?, ?)
        """, (player['name'], team_id, player.get('goals', 0), player.get('assists', 0)))

conn.commit()
conn.close()

print("league.db has been created and populated successfully!")
